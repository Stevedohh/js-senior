Большую часть работы рендеринга и отслеживания изменений Angular осуществляет с помощью библиотеки zone.js. Все приложение разделяется на секторы, каждый из которых запоминает контекст асинхронного выполнения. Такой подход после завершения асинхронной операции позволяет запустить механизм отслеживания изменений в нужном секторе.

Zone.js создает контекст исполнения, называемый "Zone", который позволяет перехватывать и обрабатывать асинхронные операции, такие как обработка событий или вызовы setTimeout. Она обертывает и модифицирует глобальные API, такие как setTimeout, XMLHttpRequest и другие, чтобы отслеживать начало и завершение асинхронных операций. Когда асинхронная операция завершается, Zone.js оповещает Angular об этом, и тот запускает механизм обнаружения изменений.

Если говорить пошагово то

1.  Angular создает особую зону, называемую "NgZone", для каждого приложения.
2.  Все асинхронные операции, связанные с Angular, выполняются внутри этой зоны.
3.  Когда асинхронная операция завершается, Zone.js оповещает NgZone.
4.  NgZone, в свою очередь, инициирует механизм обнаружения изменений, чтобы обновить представление.


Модуль ngZone в ангуляре использует zone.js. Если говорить очень упрощенно он нужен для того чтобы отслеживать стрим onMicrotaskEmpty и вызвать ChangeDetection. Таким образом Ангуляр всегда знает когда нужно вызвать ChangeDetection.

## ChangeDetectionStrategy

`ChangeDetectionStrategy` в Angular определяет стратегию, используемую для обнаружения изменений в компоненте. Angular предлагает две основные стратегии обнаружения изменений: `Default` и `OnPush`.

1.  **Default (ChangeDetectionStrategy.Default)**: Это стандартная стратегия обнаружения изменений, используемая по умолчанию во всех компонентах Angular. С этой стратегией Angular будет проверять изменения в компоненте и его дочерних компонентах каждый раз, когда происходит какое-либо событие, связанное с пользовательским интерфейсом, а также при завершении асинхронных вызовов, таких как `setTimeout`, `Promise`, или `Observable`. Это может привести к множественным проверкам на изменения, даже если они не требуются, что сказывается на производительности приложения.
    
2.  **OnPush (ChangeDetectionStrategy.OnPush)**: Эта стратегия оптимизирует процесс обнаружения изменений, выполняя его только тогда, когда изменяются входные свойства (`@Input()`) компонента или когда внутри компонента происходит событие, которое явно инициирует проверку на изменения, например вызовом `markForCheck()`. Таким образом, эта стратегия сокращает количество проверок на изменения, улучшая производительность приложения, особенно при большом количестве компонентов.


## Angular Ivy

Angular Ivy - это третье поколение компилятора и движка рендеринга для Angular, которое было представлено в версии 9.

Ivy работает на основе двух основных концепций:

1.  **Локальное обнаружение изменений**: Вместо того чтобы генерировать код для обнаружения изменений на уровне всего приложения, Ivy генерирует код для каждого компонента индивидуально. Это упрощает анализ и ускоряет компиляцию.
    
2.  **Инкрементальная компиляция**: Ivy компилирует каждый компонент независимо и кэширует результаты. Это означает, что при изменении одного компонента, Ivy перекомпилирует только этот компонент и его зависимости, а не всё приложение целиком. Это ускоряет процесс разработки и сборки.

Ivy привносит несколько преимуществ в Angular:

1.  **Уменьшение размера сборок**: Ivy генерирует более эффективный код и удаляет неиспользуемые части фреймворка из сборки благодаря "tree-shaking". В результате, размер финальных сборок уменьшается, что приводит к быстрому загрузке и запуску приложений.