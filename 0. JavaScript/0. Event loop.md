
**JavaScript** - это однопоточный, интерпритируемым ЯП. 

> В интерпритаторе JavaScript есть так же и JIT компиляторы.

**Интерпритатор** - это програма которая воспроизводит программы написаные на каком то из *ЯП*.

**Компилятор** - это программа которая переводит код с языка *ЯП0* в код на языке *ЯП1*.

JavaScript код компилируется не браузером, а **JS — движком**, который в каждом браузере свой.

---

**Event loop** - это отдельный механизм позволяющий оптимизировать работу однопоточных ЯП. Посредством реализации неблокируещей модели ввода и вывода.

**Event loop состоит из трех частей:**
1. *Call stack* - это [[5. Stack|стек]] в который попадают все объявленные вызовы функций и методов.
2. *Microtask queue* - это очередь асинхронных обратных вызовов (Promises, queueMicrotask, mutationObserver)
3. *Macrotask queue* - это очередь асинхронных обратных вызовов (Timeouts, Intervals, Clicks, Render)

**Задачи из очереди выполняются только после вызова всех функций.**

**Задачи в JavaScript разделяют на:**
- макротаски - асинхронные веб апи
- микротаски - [promises], [await].


**Рендеринг** никогда не происходит во время выполнения задачи движком. Не имеет значения, сколь долго выполняется задача. Изменения в DOM отрисовываются только **после** того, как **задача выполнена**.


Если задача выполняется очень долго, то браузер не может выполнять другие задачи, обрабатывать пользовательские события, поэтому спустя некоторое время браузер предлагает «убить» долго выполняющуюся задачу. Такое возможно, когда в скрипте много сложных вычислений или ошибка, ведущая к бесконечному циклу.

### Отличия в Node.js 

**Node.js** для реализации цикла событий использует библиотку написанную на *C* **libuv**. Которая имеет доступ к многопоточночти и может некоторые задачи запускать паралельно. По дефолту **libuv** использует 4 потока, но это значение можно изменять с версии 11.7.0 с помощью **worker_threads**.

![[Pasted image 20230227190420.png]]